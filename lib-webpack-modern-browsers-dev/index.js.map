{"version":3,"sources":["../src/index.js"],"names":["levels","RecordType","level","key","displayName","datetime","Date","message","context","metadata","extra","HandlerType","minLevel","isHandling","handle","ProcessorType","ConfigForLoggerType","handlers","processors","global","__NIGHTINGALE_GET_CONFIG_FOR_LOGGER","__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD","filter","handler","getConfigForLoggerRecord","recordLevel","Logger","constructor","includes","warn","replace","getHandlersAndProcessors","getConfig","child","childSuffixKey","childDisplayName","logger","setContext","_context","extendsContext","extendedContext","Object","assign","addRecord","record","length","ERROR","console","log","forEach","process","some","INFO","options","undefined","trace","metadataStyles","TRACE","debug","DEBUG","notice","NOTICE","info","WARN","error","Error","name","critical","CRITICAL","fatal","FATAL","alert","ALERT","inspectValue","value","inspectVar","varName","varValue","success","infoSuccess","symbol","styles","debugSuccess","fail","infoFail","debugFail","time","now","infoTime","timeEnd","startTime","diffTime","readableTime","seconds","Math","floor","timeMs","infoTimeEnd","infoSuccessTimeEnd","enter","fn","functionName","exit","wrap","callback"],"mappings":"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","file":"index.js","sourcesContent":["import util from 'util';\nimport levels from 'nightingale-levels';\n\ntype RecordType = {\n  level: number,\n  key: string,\n  displayName: ?string,\n  datetime: Date,\n  message: string,\n  context: ?Object,\n  metadata: ?Object,\n  extra: ?Object,\n};\n\ntype HandlerType = {\n  minLevel: number,\n  isHandling: ?() => boolean,\n  handle: ?(record: RecordType) => boolean,\n};\n\ntype ProcessorType = (record: RecordType) => void;\n\ntype ConfigForLoggerType = {\n  handlers: Array<HandlerType>,\n  processors: Array<ProcessorType>,\n};\n\nif (!global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER) {\n  global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER = function (): ConfigForLoggerType {\n    return { handlers: [], processors: [] };\n  };\n}\n\nif (!global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD) {\n  global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD = (\n    (key: string, level: number): ConfigForLoggerType => {\n      const { handlers, processors } = global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER(key);\n\n      return {\n        handlers: handlers.filter(handler => (\n          level >= handler.minLevel && (!handler.isHandling || handler.isHandling(level, key))\n        )),\n        processors: processors,\n      };\n    }\n  );\n}\n\n\n/** @private */\nfunction getConfigForLoggerRecord(key: ?string, recordLevel: number): ConfigForLoggerType {\n  return global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD(key, recordLevel);\n}\n\n/**\n * Interface that allows you to log records.\n * This records are treated by handlers\n */\nexport default class Logger {\n  key: string;\n  displayName: ?string;\n\n  /**\n   * Create a new Logger\n   *\n   * @param {string} key\n   * @param {string} [displayName]\n   */\n  constructor(key: string, displayName: ?string) {\n    this.key = key;\n    this.displayName = displayName;\n\n    if (key.includes('.')) {\n      this.warn('nightingale: `.` in key is deprecated, replace with `:`', { key, displayName });\n      this.key = key.replace(/\\./g, ':');\n    }\n  }\n\n  /** @private */\n  getHandlersAndProcessors(recordLevel: number): ConfigForLoggerType {\n    return getConfigForLoggerRecord(this.key, recordLevel);\n  }\n\n  /** @private */\n  getConfig(): ConfigForLoggerType {\n    return global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER(this.key);\n  }\n\n  /**\n   * Create a child logger\n   */\n  child(childSuffixKey: string, childDisplayName: ?string): Logger {\n    return new Logger(`${this.key}:${childSuffixKey}`, childDisplayName);\n  }\n\n  /**\n   * Create a new Logger with the same key a this attached context\n   *\n   * @example\n   * const loggerMyService = new Logger('app.myService');\n   * function someAction(arg1) {\n   *     const logger = loggerMyService.context({ arg1 });\n   *     logger.info('starting');\n   *     // do stuff\n   *     logger.info('done');\n   * }\n   *\n   */\n  context(context: Object): Logger {\n    const logger = new Logger(this.key);\n    logger.setContext(context);\n    return logger;\n  }\n\n  /**\n   * Set the context of this logger\n   *\n   * @param {Object} context\n   */\n  setContext(context: Object) {\n    this._context = context;\n  }\n\n  /**\n   * Extends existing context of this logger\n   */\n  extendsContext(extendedContext: Object) {\n    Object.assign(this._context, extendedContext);\n  }\n\n  /**\n   * Handle a record\n   *\n   * Use this only if you know what you are doing.\n   */\n  addRecord(record: Object) {\n    let { handlers, processors } = this.getHandlersAndProcessors(record.level);\n\n    if (handlers.length === 0) {\n      if (record.level > levels.ERROR) {\n        // eslint-disable-next-line no-console\n        console.log('[nightingale] no logger for > error level.', {\n          key: record.key,\n          message: record.message,\n        });\n      }\n      return;\n    }\n\n    if (processors) {\n      processors.forEach(process => process(record, record.context));\n    }\n\n    handlers.some(handler => handler.handle(record) === false);\n  }\n\n  /**\n   * Log a message\n   */\n  log(\n    message: string,\n    metadata: ?Object,\n    level: number = levels.INFO,\n    options: ?Object = undefined,\n  ) {\n    let context = metadata && metadata.context;\n    if (metadata) {\n      delete metadata.context;\n    }\n\n    let record = {\n      level: level,\n      key: this.key,\n      displayName: this.displayName,\n      datetime: new Date(),\n      message: message,\n      context: context || this._context,\n      metadata: metadata,\n      extra: {},\n    };\n\n    if (options) {\n      record = Object.assign(options, record);\n    }\n\n    this.addRecord(record);\n  }\n\n\n  /**\n   * Log a trace message\n   */\n  trace(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.TRACE, { metadataStyles });\n  }\n\n\n  /**\n   * Log a debug message\n   */\n  debug(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.DEBUG, { metadataStyles });\n  }\n\n  /**\n   * Notice an info message\n   */\n  notice(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.NOTICE, { metadataStyles });\n  }\n\n  /**\n   * Log an info message\n   */\n  info(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.INFO, { metadataStyles });\n  }\n\n  /**\n   * Log a warn message\n   */\n  warn(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.WARN, { metadataStyles });\n  }\n\n  /**\n   * Log an error message\n   */\n  error(message: string | Error, metadata: Object = {}, metadataStyles: ?Object) {\n    if (message instanceof Error) {\n      metadata.error = message;\n      message = `${metadata.error.name}: ${metadata.error.message}`;\n    }\n    this.log(message, metadata, levels.ERROR, { metadataStyles });\n  }\n\n  /**\n   * Log an critical message\n   */\n  critical(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.CRITICAL, { metadataStyles });\n  }\n\n  /**\n   * Log a fatal message\n   */\n  fatal(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.FATAL, { metadataStyles });\n  }\n\n  /**\n   * Log an alert message\n   */\n  alert(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.ALERT, { metadataStyles });\n  }\n\n  /**\n   * Log an inspected value\n   */\n  inspectValue(value: any, metadata: ?Object, metadataStyles: ?Object) {\n    if (BROWSER) {\n      throw new Error('Not supported for the browser. Prefer `debugger;`');\n    } else {\n      // Note: inspect is a special function for node:\n      // https://github.com/nodejs/node/blob/a1bda1b4deb08dfb3e06cb778f0db40023b18318/lib/util.js#L210\n      value = util.inspect(value, { depth: 6 });\n      this.log(value, metadata, levels.DEBUG, { metadataStyles, styles: ['gray'] });\n    }\n  }\n\n  /**\n   * Log a debugged var\n   */\n  inspectVar(varName: string, varValue: any, metadata: ?Object, metadataStyles: ?Object) {\n    if (BROWSER) {\n      throw new Error('Not supported for the browser. Prefer `debugger;`');\n    } else {\n      varValue = util.inspect(varValue, { depth: 6 });\n      this.log(\n        `${varName} = ${varValue}`,\n        metadata,\n        levels.DEBUG,\n        { metadataStyles, styles: ['cyan'] },\n      );\n    }\n  }\n\n  /**\n   * Alias for infoSuccess\n   */\n  success(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.infoSuccess(message, metadata, metadataStyles);\n  }\n\n  /**\n   * Log an info success message\n   */\n  infoSuccess(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.INFO, {\n      metadataStyles,\n      symbol: '✔',\n      styles: ['green', 'bold'],\n    });\n  }\n\n  /**\n   * Log an debug success message\n   */\n  debugSuccess(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.DEBUG, {\n      metadataStyles,\n      symbol: '✔',\n      styles: ['green'],\n    });\n  }\n\n  /**\n   * Alias for infoFail\n   */\n  fail(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.infoFail(message, metadata, metadataStyles);\n  }\n\n  /**\n   * Log an info fail message\n   */\n  infoFail(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.INFO, {\n      metadataStyles,\n      symbol: '✖',\n      styles: ['red', 'bold'],\n    });\n  }\n\n  /**\n   * Log an debug fail message\n   */\n  debugFail(message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.log(message, metadata, levels.DEBUG, {\n      metadataStyles,\n      symbol: '✖',\n      styles: ['red'],\n    });\n  }\n\n  /**\n   * @returns {number} time to pass to timeEnd\n   */\n  time(\n    message: ?string,\n    metadata: ?Object,\n    metadataStyles: ?Object,\n    level: number = levels.DEBUG,\n  ): number {\n    if (message) {\n      this.log(message, metadata, level, { metadataStyles });\n    }\n\n    return Date.now();\n  }\n\n  infoTime(message: ?string, metadata: ?Object, metadataStyles: ?Object): number {\n    return this.time(message, metadata, metadataStyles, levels.INFO);\n  }\n\n  /**\n   * Finds difference between when this method\n   * was called and when the respective time method\n   * was called, then logs out the difference\n   * and deletes the original record\n   */\n  timeEnd(\n    startTime: number,\n    message: string,\n    metadata: Object = {},\n    metadataStyles: ?Object,\n    level: number = levels.DEBUG,\n    options: ?Object,\n  ) {\n    const now = Date.now();\n\n    const diffTime = now - startTime;\n\n    if (diffTime < 1000) {\n      metadata.readableTime = `${diffTime}ms`;\n    } else {\n      const seconds = diffTime > 1000 && Math.floor(diffTime / 1000);\n      const ms = diffTime - (seconds * 1000);\n      metadata.readableTime = `${seconds ? `${seconds}s and ` : ''}${ms}ms`;\n    }\n\n    metadata.timeMs = diffTime;\n    this.log(message, metadata, level, { ...options, metadataStyles });\n  }\n\n  /**\n   * Like timeEnd, but with INFO level\n   */\n  infoTimeEnd(time: number, message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.timeEnd(time, message, metadata, metadataStyles, levels.INFO);\n  }\n\n  /**\n   * Like timeEnd, but with INFO level\n   */\n  infoSuccessTimeEnd(time: number, message: string, metadata: ?Object, metadataStyles: ?Object) {\n    this.timeEnd(time, message, metadata, metadataStyles, levels.INFO, {\n      symbol: '✔',\n      styles: ['green', 'bold'],\n    });\n  }\n\n  /**\n   * Log an enter in a function\n   *\n   * @example\n   * class A {\n   *   method(arg1) {\n   *     logger.enter(method, { arg1 });\n   *     // Do your stuff\n   *   }\n   * }\n   *\n   */\n  enter(fn: Function, metadata: ?Object, metadataStyles: ?Object) {\n    metadata = {\n      functionName: fn.name,\n      ...metadata,\n    };\n    this.log('enter', metadata, levels.TRACE, { metadataStyles });\n  }\n\n  /**\n   * Log an exit in a function\n   *\n   * @example\n   * const logger = new ConsoleLogger('myNamespace.A');\n   * class A {\n   *   method(arg1) {\n   *     // Do your stuff\n   *     logger.exit(method, { arg1 });\n   *   }\n   * }\n   */\n  exit(fn: Function, metadata: ?Object, metadataStyles: ?Object) {\n    metadata = {\n      functionName: fn.name,\n      ...metadata,\n    };\n    this.log('exit', metadata, levels.TRACE, { metadataStyles });\n  }\n\n  /**\n   * Wrap around a function to log enter and exit of a function\n   *\n   * @example\n   * const logger = new ConsoleLogger('myNamespace.A');\n   * class A {\n     *   method() {\n     *     logger.wrap(method, () => {\n     *       // Do your stuff\n     *     });\n     *   }\n     * }\n   *\n   * @param {Function} fn\n   * @param {Object} [metadata]\n   * @param {Object} [metadataStyles]\n   * @param {Function} callback\n   */\n  wrap(\n    fn: Function,\n    metadata: ?Object | Function,\n    metadataStyles: ?Object | Function,\n    callback: Function,\n  ) {\n    if (typeof metadata === 'function') {\n      callback = metadata;\n      metadata = undefined;\n    } else if (typeof metadataStyles === 'function') {\n      callback = metadataStyles;\n      metadataStyles = undefined;\n    }\n\n    this.enter(fn, metadata, metadataStyles);\n    callback();\n    this.exit(fn);\n  }\n}\n"]}